const bar=document.getElementById("bar"),close=document.getElementById("close"),nav=document.getElementById("navbar");bar&&bar.addEventListener("click",(()=>{nav.classList.add("active")})),close&&close.addEventListener("click",(()=>{nav.classList.remove("active")}));var cartId="cart",localAdapter={saveCart:function(t){var e=JSON.stringify(t);return localStorage.setItem(cartId,e),!0},getCart:function(){return JSON.parse(localStorage.getItem(cartId))},clearCart:function(){localStorage.removeItem(cartId)}},storage=localAdapter,helpers={getHtml:function(t){return document.getElementById(t).innerHTML},setHtml:function(t,e){return document.getElementById(t).innerHTML=e,!0},itemData:function(t){var e=t.querySelector(".count"),a=new RegExp("^[1-9]([0-9]+)?р");return e.value=!0===a.test(e.value)?parseInt(e.value):1,{name:t.getAttribute("data-name"),price:t.getAttribute("data-price"),id:t.getAttribute("data-id"),count:e.value,total:parseInt(t.getAttribute("data-price"))*parseInt(e.value)}},updateView:function(){var t=cart.getItems(),e=this.getHtml("cartT"),a=_.template(e,{items:t});this.setHtml("cartItems",a),this.updateTotal()},emptyView:function(){this.setHtml("cartItems","<p>Тут ничего нет</p>"),this.updateTotal()},updateTotal:function(){this.setHtml("totalPrice",cart.total+"р")}},cart={count:0,total:0,items:[],getItems:function(){return this.items},setItems:function(t){this.items=t;for(var e=0;e<this.items.length;e++){var a=this.items[e];this.total+=a.total}},clearItems:function(){this.items=[],this.total=0,storage.clearCart(),helpers.emptyView()},addItem:function(t){!1===this.containsItem(t.id)?(this.items.push({id:t.id,name:t.name,price:t.price,count:t.count,total:t.price*t.count}),storage.saveCart(this.items)):this.updateItem(t),this.total+=t.price*t.count,this.count+=t.count,helpers.updateView()},containsItem:function(t){if(void 0===this.items)return!1;for(var e=0;e<this.items.length;e++){if(t==this.items[e].id)return!0}return!1},updateItem:function(t){for(var e=0;e<this.items.length;e++){var a=this.items[e];t.id===a.id&&(a.count=parseInt(t.count)+parseInt(a.count),a.total=parseInt(t.total)+parseInt(a.total),this.items[e]=a,storage.saveCart(this.items))}}};document.addEventListener("DOMContentLoaded",(function(){storage.getCart()?(cart.setItems(storage.getCart()),helpers.updateView()):helpers.emptyView();var t=document.querySelectorAll(".product button");[].forEach.call(t,(function(t){t.addEventListener("click",(function(t){var e=helpers.itemData(this.parentNode);cart.addItem(e)}))})),document.querySelector("#clear").addEventListener("click",(function(t){cart.clearItems()}))}));